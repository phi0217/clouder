
#####<a href="#第一段的锚点名称">第一段标题</a>

## 接口请求流程
1. 客户发起风控请求
2. 客户接收风控回调，如果用户接收失败，重试回调。
3. 客户数据共享

## 接口请求涉及的功能
1. 客户身份验证
    - 加密规则
    - ip白名单
    - 余额检查
2. 短时间请求频率控制，单日上限控制
3. 参数适配
    - 制定参数标准化规范，尤其需要注意通讯录部分 
4. 订单参数校验
    - 订单重复请求（直接返回上一次风控结果）
    - 缺少必要参数（返回提示信息）
    - 参数使用异常（日志监控，重点防范影响口径的参数连续空值，非约定值）
4. 客户请求记录
    - 记录订单信息（要用对方主键生成新的代理主键，避免主键冲突），用户信息，请求参数，请求时间
    - 记录风控结果，请求时间，完成时间，使用到的三方接口
    - 扣费
5. 风控正确性监控
    - 百笔订单，三方请求次数飘移
    - 百笔订单，风控结论占比飘移
6. 异常处理
    - 拆出不影响主流程的代码异步处理（变量关系化等）
    - 主流程出现异常，订单落库，第一时间报警，并在修复后重新回调用户
    - 三方接口失败重试（避免重复计费）
7. 客户数据共享接口
    - 客户批量上传or客户提供查询接口。我选择客户提供查询接口，可以快速验收查询接口。用户批量上传在用户还款后才能验收，根据以往对接三方的经验，这种方式难以监督用户上传数据，验收周期太长，费时费力
    - 客户数据定时查询落库
    - 客户数据完整性比对
    - 客户共享数据定义（需要文学、成辉确认）
        - 商户名、订单id、期限、额度、费率、借款时间、拒绝时间、放款时间、到账时间、应还时间、还款时间

## 业务使用
1. 接口对接（风控、风控回调、数据共享）
2. 对账

## 业务使用对应工作
1. 测试接口提供
2. 接口文档编写
    - 对接方案
    - 参数示意
3. 对接邮件模板
4. 云梯管理后台
    - 登陆
    - 改密
    - 充值总额、余额
    - 日消费、月消费
    - 风控详单
    - 风控详单excel导出
    - 单笔计费规则配置

## 高并发，海量数据
1. 峰值压力预估
    - 目前风控峰值每分钟15单（批量风控的情况除外），10倍压力就是150单/min，考虑到用户可能存在批量请求风控的情况，削峰后至少要扛200单/min
    - 一笔风控，网络读0.05mb，数据库写0.12mb，写350行数据。每分钟200单，网络读20mb，数据库写24mb，写70000行数据
    - 按照一日10万笔风控计算，风控每日新增数据12gb，三千五百万行
2. 按照商户分配线程数上限
3. 业务监控
    - 风控平均耗时过长
    - 风控线程池排队过长
4. 设备资源监控及性能监控


####<a name="第一段的锚点名称">第一段标题</a>

## 人员配置
- 岐超项目经理，松哥架构，我，另加两位开发
- 之所以另加两位是因为在风控输出开发工作的同时，风控常规迭代不能停，之后配置调整、规则新增、数据源接入的工作不会更少，只会更多。风控输出是长久的工作，不能想着风控输出腾出手来风控常规迭代再做打算。风控开发引入新人上手需要时间，新人进入项目的越早越好。
- 新增开发的硬性要求
    - 数据库能力过硬，能快速理解业务并能根据业务进行sql统计，了解sql性能影响因素
    - 能清楚的阐述新功能测试流程，保障系统正确性的验证流程，故障排查思路
    - 业务流程，开发思路能表达清楚
    - 有上线项目维护经验
